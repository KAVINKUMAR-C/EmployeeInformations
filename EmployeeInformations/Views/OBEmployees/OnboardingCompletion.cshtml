  @using EmployeeInformations.Model.OnboardingViewModel;
  @model OnboardingCompletion 
@{
    Layout = "_Layout";
}

<div class="onboarding">
    <div class="onboard-title">
         <h3>Onboarding Completion</h3>
    </div>
    @Html.HiddenFor(e=>e.RoleId)
    @Html.HiddenFor(e=>e.EmpId)
    @Html.HiddenFor(e=>e.ProfileCompletion)
    <div class="onboard-text py-5 text-center">
        <div>
        <h4 class="mb-3">Welcome to our Team!</h4>
            <p> Dear @Model.EmployeeName! <br> Congratulations on successfully completing your onboarding process at vphospital!
                We are delighted to officially welcome you as an integral part of our team.</p>
        </div>
       <div class="my-5">
            <h4 class="mb-3">You are almost Done!</h4>
            <p>Take time to make sure you have completed each step in this Onboarding guide.</p>
        </div>
        <h4 class="mb-3">Profile progress</h4>
       @* accordion-card*@
        <div id="accordion" class="card-accordion">
            @*card1*@
            <div class="card">
                <div class="card-header d-flex justify-content-between">
                    <h5 class="mb-0 my-auto">
                        <button class="btn btn-link">
                           <span>Welcome Aboard</span> 
                        </button>
                    </h5>
                    <div class="form-check my-auto">
                        <input type="checkbox" onclick="return false" class="form-check-input" id="exampleCheck1" checked>
                    </div>
                </div>
            </div>
            @*card2*@
            <div class="card">
                <div class="card-header d-flex justify-content-between" id="headingTwo" data-toggle="collapse" data-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
                    <h5 class="mb-0 my-auto">
                        <button class="btn btn-link collapsed" id="check">
                          <span>Profile Completion</span> 
                        </button>
                    </h5>
                    <div class="my-auto circle-down">
                        <em class="icon ti-arrow-circle-up"></em>
                    </div>
                </div>
                <div id="collapseTwo" class="collapse show" aria-labelledby="headingTwo" data-parent="#accordion">
                    <div class="card-body">
                      <ul class="d-flex flex-column">
                            <li class="d-flex justify-content-between mt-3 mb-4"> 
                                <div>
                                    <em class="icon ti-user mr-2 bg-primary p-2 "></em> Profile Info
                                </div>
                                @if (Model.ProfileInfo == 1)
                                {
                                    <div class="form-check">
                                        <input type="checkbox" onclick="return false" class="form-check-input" id="exampleCheck1" checked>
                                    </div>
                                }
                                else
                                {
                                    <div class="form-check">
                                        <input type="checkbox" onclick="return false" class="form-check-input" id="exampleCheck1">
                                    </div>
                                }

                            </li> 
                            <li class="d-flex justify-content-between mb-4">
                                <div>
                                <em class="icon ti-id-badge mr-2 bg-primary p-2"></em>Address Info
                                </div>
                                @if (Model.AddressInfo == 1)
                                {
                                    <div class="form-check">
                                        <input type="checkbox" onclick="return false" class="form-check-input" id="exampleCheck1" checked>
                                    </div>
                                }
                                else
                                {
                                    <div class="form-check">
                                        <input type="checkbox" onclick="return false" class="form-check-input" id="exampleCheck1">
                                    </div>
                                }
                                
                            </li>
                            <li class="d-flex justify-content-between mb-4">
                                <div>
                                    <em class="icon ti-folder mr-2 bg-primary p-2"></em>Other Details
                                </div>
                                @if (Model.OtherDetails == 1)
                                {
                                    <div class="form-check">
                                        <input type="checkbox" onclick="return false" class="form-check-input" id="exampleCheck1" checked>
                                    </div>
                                }
                                else
                                {
                                    <div class="form-check">
                                        <input type="checkbox" onclick="return false" class="form-check-input" id="exampleCheck1">
                                    </div>
                                }
                            </li>
                            <li class="d-flex justify-content-between mb-4">
                                <div>
                                    <em class="icon ti-medall mr-2 bg-primary p-2"></em>Qualification Info
                                </div>
                                @if (Model.QualificationInfo == 1)
                                {
                                    <div class="form-check">
                                        <input type="checkbox" onclick="return false" class="form-check-input" id="exampleCheck1" checked>
                                    </div>
                                }
                                else
                                {
                                    <div class="form-check">
                                        <input type="checkbox" onclick="return false" class="form-check-input" id="exampleCheck1">
                                    </div>
                                }
                            </li>
                            <li class="d-flex justify-content-between mb-4">
                                <div>
                                    <em class="icon ti-tag mr-2 bg-primary p-2"></em>Experience Info
                                </div>
                                @if (Model.BankDetails == 1)
                                {
                                    <div class="form-check">
                                        <input type="checkbox" onclick="return false" class="form-check-input" id="exampleCheck1" checked>
                                    </div>
                                }
                                else
                                {
                                    <div class="form-check">
                                        <input type="checkbox" onclick="return false" class="form-check-input" id="exampleCheck1">
                                    </div>
                                }
                            </li>
                            <li class="d-flex justify-content-between mb-4">
                                <div>
                                    <em class="icon ti-credit-card mr-2 bg-primary p-2"></em>Bank Details
                                </div>
                                @if (Model.BankDetails == 1)
                                {
                                    <div class="form-check">
                                        <input type="checkbox" onclick="return false" class="form-check-input" id="exampleCheck1" checked>
                                    </div>
                                }
                                else
                                {
                                    <div class="form-check">
                                        <input type="checkbox" onclick="return false" class="form-check-input" id="exampleCheck1">
                                    </div>
                                }
                            </li>
                      </ul>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-lg-12 d-flex mt-3 p-0">
            <input type="button" class="btn btn-secondary" id="btnBack" value="Go to profile" />
            <input type="button" class="btn btn-primary ml-auto mr-3" id="btnDashboard" value="Let's go" />
        </div>
    </div>
</div>


<script src="https://code.jquery.com/jquery-3.3.1.min.js"> </script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/js/bootstrap.min.js"> </script>

<script>

    $("#accordion").on("hide.bs.collapse show.bs.collapse", e => {
        $(e.target)
            .prev()
            .find("i:last-child")
            .toggleClass("fa-minus fa-plus");
    });


    

    $("#btnBack").click(function(){
    
        window.location.href = "/OBEmployees/EditEmployees";
    });

    $("#btnDashboard").click (function(){
     
         var empId = $("#EmpId").val();
        var profileCompletion = $("#ProfileCompletion").val();

       if (profileCompletion > 60 || profileCompletion == 60) {
         $.ajax({

            type: "POST",
            url: "/OBEmployees/UpdateOnboarding",
            dataType: "Json",
            data: { EmpID: empId },
            success: (result) => {

                if (result == 1) {
                    var roleId = $("#RoleId").val();
                    if (roleId == 5) {
                        var urlToRedirect = '@Url.Action("EmployeeHome","Dashboard")';
                        window.location.href = urlToRedirect
                    }
                    else {
                        var urlToRedirect = '@Url.Action("Home","Dashboard")';
                        window.location.href = urlToRedirect
                    }
                }
            },
            error: (result) => {
                $('.loader').addClass('d-none');
            }

        });
       }
        else {
            swal.fire({
                title: "Please complete Profile",
                text: "",
                icon: "warning",
                allowOutsideClick: false  // This prevents closing on outside click
            }).then((resultValue) => {
                if (resultValue.isConfirmed) {
                    var urlToRedirect = '@Url.Action("EditEmployees", "OBEmployees")';
                    window.location.href = urlToRedirect;
                };
            });
        
        $('.loader').addClass('d-none');
        }

   
       
    });

</script>
